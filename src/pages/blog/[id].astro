---
import Layout from "@/layouts/Layout.astro";
import { Image } from "astro:assets";
import defaultCover from "@/assets/default.jpg";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post) => ({
        params: { id: post.id },
        props: { post }
    }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<Layout>
    <section class="pt-20 min-h-full">
        <div class="container mx-auto w-full max-w-7xl flex flex-col px-6">
            <div class="flex flex-col w-full py-6">
                <Image src={post.data.thumbnail || defaultCover} alt={post.data.title} class="rounded-lg aspect-21/9 object-cover object-center mb-4" />
                <div class="flex flex-col justify-start text-left w-full">
                    <p class="text-sm text-gray-600">{ post.data.publishedAt.toLocaleDateString("ja-jp") }</p>
                    <h2 class="text-2xl font-bold">{ post.data.title }</h2>
                    <p class="text-sm text-gray-600">{ post.data.description }</p>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 w-full">
                <div class="md:col-span-2 leading-relaxed prose prose-base min-w-full">
                    <Content />
                </div>
            </div>
        </div>
    </section>
</Layout>